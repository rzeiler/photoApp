(function(c){var b=null;var a=null;function d(){can=document.getElementById("Image");var e=can.toDataURL("image/jpeg",1);c("div.workplace").css("background-image","url("+e+")")}c.fn.ImageWorker=function(e){Caman.Filter.register("oldpaper",function(){this.pinhole();this.noise(10);this.orangePeel();this.render()});Caman.Filter.register("pleasant",function(){this.colorize(60,105,218,10);this.contrast(10);this.sunrise();this.hazyDays();this.render()});var f=c.extend({max_height:200,filter:null,thunbs:null,adjust:null,src:null},e);o=this;o.on("load",function(){a=this;b=Caman(a);Caman.Event.listen("processStart",function(h){console.log("Start:",h.name);c(".preloader-text").text("Start:"+h.name);var g=c(document).outerHeight();c(".preloader-holder").css("height",g+"px").show();c("body").css("overflow","hidden")});Caman.Event.listen(b,"renderFinished",function(g){console.log("Finished:",g.name);c(".preloader-text").text("Finished:"+g.name);c(".preloader-holder").hide();c("body").css("overflow","auto")});Caman.Event.listen("processComplete",function(g){console.log("Finished:",g.name);c(".preloader-holder").hide();c("body").css("overflow","auto")});b.domIsLoaded(function(){d();if(f.thunbs){var g=document.getElementById("Image");c.each(f.thunbs,function(){var h=c(this);var i=c("<img/>");i.attr("src","images/"+h.data("filter")+".png");h.append(i)});c(".preloader-holder").hide()}})});if(f.filter){f.filter.click(function(){var g=c.trim(c(this).data("filter"));var h=c.trim(c(this).data("value"));can=document.getElementById("Image");Caman(can,f.src,function(){if(g in this){this[g](h);this.render(function(){d()})}})})}if(f.adjust){f.adjust.change(function(){var g=c.trim(c(this).data("filter"));var h=c.trim(c(this).val());can=document.getElementById("Image");Caman(can,f.src,function(){var i=this;i.revert(false);f.adjust.each(function(){var j=c.trim(c(this).data("filter"));var k=c.trim(c(this).val());if(j in i){i[j](k)}});i.render(function(){d()})})})}}}(jQuery));